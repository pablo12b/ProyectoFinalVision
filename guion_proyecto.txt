GUION DEL PROYECTO FINAL: SISTEMA DE VIGILANCIA INTELIGENTE (VERSI√ìN ACTUALIZADA)

Este proyecto implementa un sistema de vigilancia distribuido que combina **C++ (Eficiencia)** y **Python (Inteligencia)**, cumpliendo con la r√∫brica mediante m√©tricas de rendimiento y gesti√≥n de usuarios.

---

### 1. El Vigilante Optimizado: `main.cpp` (C++)
**Rol:** Detecci√≥n de intrusos en tiempo real con monitoreo de recursos.

*   **Detecci√≥n de Alta Sensibilidad:**
    *   Usa **HOG con SVM** configurado para m√°xima sensibilidad (`hitThreshold=0.1`).
    *   **Filtros Inteligentes:**
        *   Descarta falsos positivos por altura (< 50 p√≠xeles).
        *   Analiza la proporci√≥n (Ratio 0.2 a 1.2) para detectar personas incluso si est√°n agachadas.
    *   **Visualizaci√≥n de Confianza:** Muestra el nivel de certeza del algoritmo sobre cada detecci√≥n en tiempo real.

*   **Cumplimiento de R√∫brica (M√©tricas):**
    *   **FPS (Frames Por Segundo):** Calcula y muestra la fluidez del video en la esquina superior izquierda.
    *   **Consumo de RAM:** Una funci√≥n dedicada (`getRAMUsageMB`) lee el archivo del sistema `/proc/self/statm` para mostrar cu√°nta memoria usa el programa en tiempo real.

*   **L√≥gica de Alarma:**
    *   Si detecta una amenaza durante **4 frames consecutivos**, entra en estado de **ALERTA**.
    *   Muestra "ENVIANDO API..." en pantalla.
    *   Bloquea la c√°mara y cede el control a Python para el an√°lisis profundo.

---

### 2. El Cerebro Multihilo: `servidor.py` (Python)
**Rol:** Gesti√≥n de usuarios, Inteligencia Artificial avanzada (YOLO) y comunicaci√≥n.

*   **Arquitectura Multihilo (Concurrency):**
    *   El programa ejecuta **dos procesos simult√°neos**:
        1.  **Flask (Hilo Principal):** Escucha las alertas de C++ (`/subir_foto`, `/grabar_video`).
        2.  **Telegram Bot (Hilo Secundario):** Escucha comandos de usuarios sin bloquear la c√°mara.

*   **Gesti√≥n de Usuarios (`/start`):**
    *   Implementa una base de datos en memoria (`suscriptores`).
    *   Solo los usuarios que env√≠an `/start` recibir√°n las alertas (Cumple requisito de suscripci√≥n).

*   **Procesamiento Avanzado (YOLOv11):**
    *   Recibe la foto de C++ y aplica **Estimaci√≥n de Postura**.
    *   **Estampado de M√©tricas (Data Overlay):**
        *   Sobre la imagen procesada, dibuja un banner negro con datos t√©cnicos:
        *   **Conf:** Confianza promedio de la IA.
        *   **Ptos:** Cantidad de puntos del esqueleto detectados.
        *   **RAM Server:** Consumo de memoria del proceso Python en ese instante.

*   **Generaci√≥n de Evidencia de Video:**
    *   Toma el control de la c√°mara (liberada por C++).
    *   Graba 5 segundos de video mientras aplica YOLO frame a frame.
    *   Env√≠a el video resultante ("Registro de Movimiento") a todos los usuarios suscritos.

---

### üîÑ Resumen del Flujo de Datos

1.  **C++** detecta movimiento + Mide RAM/FPS ‚ûù Alerta a Python.
2.  **Python** verifica usuarios suscritos ‚ûù Si hay, procesa.
3.  **Python** analiza foto con YOLO ‚ûù Estampa M√©tricas (RAM, Confianza) ‚ûù Env√≠a a Telegram.
4.  **Python** graba video 5s con esqueleto ‚ûù Env√≠a a Telegram.
5.  **C++** recupera la c√°mara y sigue vigilando.
